function zbscrmjs_transaction_unsetCustomer(i){void 0!==i&&""!=i||(jQuery("#customer").val(""),jQuery("#customer_name").val(""),jQuery(".assignInvToCust, #invoiceFieldWrap").hide(),setTimeout(function(){zeroBSCRMJS_showContactLinkIf("")},0))}function zbscrmjs_transaction_unsetCompany(i){void 0!==i&&""!=i||(jQuery("#zbsct_company").val(""),setTimeout(function(){zeroBSCRMJS_showCompanyLinkIf("")},0))}function zbscrmjs_transaction_setCustomer(i){void 0!==i.id?(jQuery("#customer").val(i.id),jQuery("#customer_name").val(i.name),zbscrmjs_build_custInv_dropdown(i.id)):(jQuery("#customer").val(""),jQuery("#customer_name").val("")),setTimeout(function(){zeroBSCRMJS_showContactLinkIf(i.id)},0)}function zbscrmjs_transaction_setCompany(i){void 0!==i.id?jQuery("#zbsct_company").val(i.id):jQuery("#zbsct_company").val(""),setTimeout(function(){zeroBSCRMJS_showCompanyLinkIf(i.id)},0)}function zbscrmjs_build_custInv_dropdown(i,n){e=jQuery("#invoice_id").val();if(""!=i)jQuery("#invoiceFieldWrap").append(zbscrm_js_uiSpinnerBlocker()),zbscrm_js_getCustInvs(i,function(i){var e='<select id="invoice_id" name="invoice_id" class="form-control">';i.length>0?(e+='<option value="" disabled="disabled"',(void 0===n||n<=0)&&(e+=' selected="selected"'),e+=">"+zeroBSCRMJS_transEditLang("selectinv","Select Invoice")+"</option>",e+='<option value="">'+zeroBSCRMJS_transEditLang("none","None")+"</option>",jQuery.each(i,function(i,o){var t="",a=-1;zbscrm_JS_DAL()>2?(a=o.id,t="#"+o.id,void 0!==o.id_override&&(t+=" - "+o.id_override)):(a=o.id,void 0!==o.zbsid?t+="#"+o.zbsid:t+="#PID:"+o.id),void 0!==o.meta&&(void 0!==o.meta.val&&(t+=" ("+window.zbs_root.currencyOptions.currencyStr+o.meta.val+")"),void 0!==o.meta.date&&(t+=" - "+o.meta.date)),e+='<option value="'+a+'"',void 0!==n&&a==n&&(e+=' selected="selected"'),e+=">"+t+"</option>"})):e+='<option value="" disabled="disabled" selected="selected">'+zeroBSCRMJS_transEditLang("noinvoices","None Found")+"</option>",e+="</select>",jQuery("#invoiceFieldWrap").html(e),jQuery(".assignInvToCust").show(),setTimeout(function(){zeroBSCRMJS_bindInvSelect()},0)},function(i){jQuery(".assignInvToCust").hide();if(0==(n=e))var n="";jQuery("#invoiceFieldWrap").html('<input style="max-width:200px;" id="invoice_id" name="invoice_id" value="'+n+'" class="form-control">')});else{if(jQuery(".assignInvToCust").show(),0==e)var e="";jQuery("#invoiceFieldWrap").html('<input style="max-width:200px;" id="invoice_id" name="invoice_id" value="'+e+'" class="form-control">'),setTimeout(function(){zeroBSCRMJS_bindInvSelect()},0)}}function zeroBSCRMJS_bindInvSelect(){jQuery("#invoice_id").change(function(){zeroBSCRMJS_showInvLinkIf()}),zeroBSCRMJS_showInvLinkIf()}function zeroBSCRMJS_showInvLinkIf(){jQuery("#invoiceSelectionTitle .zbs-view-invoice").remove();var i=jQuery("#invoiceFieldWrap select").val();if(void 0!==i&&null!==i&&""!==i&&(i=parseInt(i))>0){var n='<div class="ui right floated mini animated button zbs-view-invoice" style="margin-left:0.5em">';n+='<div class="visible content">'+zeroBSCRMJS_transEditLang("view","View")+"</div>",n+='<div class="hidden content">',n+='<i class="icon file text"></i>',n+="</div>",n+="</div>",jQuery("#invoiceSelectionTitle").prepend(n),zeroBSCRMJS_bindInvLinkIf()}}function zeroBSCRMJS_bindInvLinkIf(){jQuery("#invoiceSelectionTitle .zbs-view-invoice").off("click").click(function(){var i=parseInt(jQuery("#invoiceFieldWrap select").val()),n=window.zeroBSCRMJS_transactionedit_links.editinvprefix+i;window.open(n,"_parent")})}function zeroBSCRMJS_showContactLinkIf(i){if(jQuery("#zbs-customer-title .zbs-view-contact").remove(),jQuery("#zbs-transaction-learn-nav .zbs-trans-quicknav-contact").remove(),void 0!==i&&null!==i&&""!==i&&(i=parseInt(i))>0){var n=window.zbsObjectViewLinkPrefixCustomer+i,e='<div class="ui right floated mini animated button zbs-view-contact">';e+='<div class="visible content">'+zeroBSCRMJS_transEditLang("view","View")+"</div>",e+='<div class="hidden content">',e+='<i class="user icon"></i>',e+="</div>",e+="</div>",jQuery("#zbs-customer-title").prepend(e);var o='<a target="_blank" style="margin-left:6px;" class="zbs-trans-quicknav-contact ui icon button blue mini labeled" href="'+n+'"><i class="user icon"></i> '+zeroBSCRMJS_transEditLang("contact","Contact")+"</a>";jQuery("#zbs-transaction-learn-nav").append(o),zeroBSCRMJS_bindContactLinkIf()}}function zeroBSCRMJS_bindContactLinkIf(){jQuery("#zbs-customer-title .zbs-view-contact").off("click").click(function(){var i=parseInt(jQuery("#customer").val());if(void 0!==i&&null!==i&&""!==i&&(i=parseInt(i))>0){var n=window.zbsObjectViewLinkPrefixCustomer+i;window.open(n,"_parent")}})}function zeroBSCRMJS_showCompanyLinkIf(i){if(jQuery("#zbs-company-title .zbs-view-company").remove(),jQuery("#zbs-transaction-learn-nav .zbs-trans-quicknav-company").remove(),void 0!==i&&null!==i&&""!==i&&(i=parseInt(i))>0){var n='<div class="ui right floated mini animated button zbs-view-company">';n+='<div class="visible content">'+zeroBSCRMJS_transEditLang("view","View")+"</div>",n+='<div class="hidden content">',n+='<i class="building icon"></i>',n+="</div>",n+="</div>",jQuery("#zbs-company-title").prepend(n);var e='<a target="_blank" style="margin-left:6px;" class="zbs-trans-quicknav-company ui icon button blue mini labeled" href="'+window.zeroBSCRMJS_transactionedit_links.editcompanyprefix+i+'"><i class="building icon"></i> '+zeroBSCRMJS_transEditLang("company","Company")+"</a>";jQuery("#zbs-transaction-learn-nav").append(e),zeroBSCRMJS_bindCompanyLinkIf()}}function zeroBSCRMJS_bindCompanyLinkIf(){jQuery("#zbs-company-title .zbs-view-company").off("click").click(function(){var i=parseInt(jQuery("#zbsct_company").val());if(void 0!==i&&null!==i&&""!==i&&(i=parseInt(i))>0){var n=window.zeroBSCRMJS_transactionedit_links.editcompanyprefix+i;window.open(n,"_parent")}})}function zeroBSCRMJS_transEditLang(i,n){if(void 0===n)n="";return void 0!==window.zeroBSCRMJS_transactionedit_lang[i]?window.zeroBSCRMJS_transactionedit_lang[i]:n}jQuery(document).ready(function(){if(jQuery("#customer").val()){var i=!1;jQuery("#invoice_id").val()&&(i=jQuery("#invoice_id").val()),zbscrmjs_build_custInv_dropdown(jQuery("#customer").val(),i)}setTimeout(function(){zeroBSCRMJS_showInvLinkIf(),zeroBSCRMJS_showContactLinkIf(jQuery("#customer").val()),zeroBSCRMJS_showCompanyLinkIf(jQuery("#zbsct_company").val())},0)});