function zbscrm_appendTextToEditor(e){"function"==typeof window.parent.send_to_editor&&window.parent.send_to_editor(e)}function zbscrm_getTemplatedQuote(e,t){if(!window.quoteTemplateBlocker){var o="";jQuery("#zbscq_customer").length>0&&(o=jQuery("#zbscq_customer").val());var r=0;jQuery("#zbs_quote_template_id").length>0&&(r=parseInt(jQuery("#zbs_quote_template_id").val()));var u="";jQuery("#name").length>0&&(u=jQuery("#name").val());var s="";jQuery("#val").length>0&&(s=jQuery("#val").val());var n="";jQuery("#date").length>0&&(n=jQuery("#date").val());var i={};if(zbscrm_JS_DAL()>2&&jQuery.map(jQuery("#zbs-edit-form").serializeArray(),function(e,t){i[e.name]=e.value}),empty(o))return empty(o)&&swal({title:"Error!",text:"Please Choose a Customer",type:"error",confirmButtonText:"OK"}),empty(r)&&swal({title:"Error!",text:"Please Choose a Template",type:"error",confirmButtonText:"OK"}),window.quoteTemplateBlocker=!1,!1;empty(r)?(window.quoteTemplateBlocker=!1,"function"==typeof e&&e()):(quoteTemplateAJAX=jQuery.ajax({url:ajaxurl,type:"POST",data:{action:"zbs_get_quote_template",quote_fields:i,cust_id:o,quote_type:r,quote_title:u,quote_val:s,quote_dt:n,security:jQuery("#quo-ajax-nonce").val()},dataType:"json"}),quoteTemplateAJAX.done(function(t){swal({title:"Success!",text:"Quote Template Populated",type:"success",confirmButtonText:"OK"}),setTimeout(function(){zbscrm_appendTextToEditor(t.html)},500),window.quoteTemplateBlocker=!1,"function"==typeof e&&e()}),quoteTemplateAJAX.fail(function(e){swal({title:"Error!",text:"Failed retrieving template! If this error persists please contact Jetpack CRM support.",type:"error",confirmButtonText:"OK"}),window.quoteTemplateBlocker=!1,"function"==typeof t&&t()}))}}function zerobscrm_js_sendQuoteNotification(e,t,o,r,u){if(!window.zerobscrm_js_sendingQuote)if(window.zerobscrm_js_sendingQuote=!0,void 0!==e&&""!=e&&zbscrm_JS_validateEmail(e)&&void 0!==t&&t>0){var s={action:"zbs_quotes_send_quote",sec:window.zbscrmjs_secToken,em:e,qid:t,cid:o};jQuery.ajax({type:"POST",url:ajaxurl,data:s,dataType:"json",timeout:2e4,success:function(e){"function"==typeof r&&r(e),window.zerobscrm_js_sendingQuote=!1},error:function(e){console.error("RESPONSE",e),"function"==typeof u&&u(e),window.zerobscrm_js_sendingQuote=!1}})}else window.zerobscrm_js_sendingQuote=!1}var quoteTemplateBlocker=!1;jQuery(document).ready(function(){jQuery("#zbsQuoteBuilderStep2").click(function(){zbscrm_getTemplatedQuote(function(){jQuery("#wpzbscsub_quotecontent").show(),jQuery("#zerobs-quote-content-edit").show(),jQuery("#wpzbscsub_quoteactions").show(),jQuery("#zerobs-quote-nextstep").show(),jQuery("#zbs-quote-builder-step-1").slideUp(),setTimeout(function(){jQuery("#zbs_quote_content_ifr").css("height","580px"),jQuery("#wpzbscsub_quotecontent").length>0&&jQuery("html, body").animate({scrollTop:jQuery("#wpzbscsub_quotecontent").offset().top},2e3),jQuery("#zerobs-quote-content-edit").length>0&&jQuery("html, body").animate({scrollTop:jQuery("#zerobs-quote-content-edit").offset().top},2e3)},0)})}),jQuery("#zbsQuoteBuilderStep3").click(function(){jQuery("#publish").click()}),jQuery("#zbsQuoteBuilderEmailTo").keyup(function(){var e=jQuery("#zbsQuoteBuilderEmailTo").val();void 0!==e&&""!=e&&zbscrm_JS_validateEmail(e)?(jQuery("#zbsQuoteBuilderEmailTo").css("border","1px solid #ddd"),jQuery("#zbsQuoteBuilderEmailToErr").hide()):(jQuery("#zbsQuoteBuilderEmailTo").css("border","2px solid orange"),jQuery("#zbsQuoteBuilderEmailToErr").show())}),jQuery("#zbsQuoteBuilderSendNotification").click(function(){var e=!0,t=jQuery("#zbsQuoteBuilderEmailTo").val(),o=jQuery("#zbsQuoteBuilderEmailTo").attr("data-quoteid"),r=jQuery("#zbscq_customer").val();void 0!==t&&""!=t&&zbscrm_JS_validateEmail(t)||(e=!1),e&&zerobscrm_js_sendQuoteNotification(t,o,r,function(e){swal({title:"Success!",text:"Quote has been emailed!",type:"success",confirmButtonText:"OK"})},function(e){swal({title:"Error!",text:"Failed Sending email to customer! If this error persists please contact Jetpack CRM support.",type:"error",confirmButtonText:"OK"})})}),void 0!==window.zbscrm_templated&&(jQuery("#zbs-quote-builder-step-1").hide(),jQuery("#wpzbscsub_quotecontent").show(),jQuery("#zerobs-quote-content-edit").show(),jQuery("#wpzbscsub_quoteactions").show(),jQuery("#zerobs-quote-nextstep").show()),jQuery("#zbsQuoteBuilderURL").length&&(document.getElementById("zbsQuoteBuilderURL").onclick=function(){this.select(),document.execCommand("copy")})});var zerobscrm_js_sendingQuote=!1;